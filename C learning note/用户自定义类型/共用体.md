**共用体**（`union`）是一种和结构体类似的自定义数据类型，但在共用体中，所有成员**共享同一段内存**。也就是说，在任意时刻，共用体中只能有一个成员存储有效值，其他成员的数据会被覆盖。因此，共用体的大小等于其最大成员的大小。

### 共用体的定义和使用

共用体的定义方式类似于结构体，使用 `union` 关键字。例如：

```c
union Data {
    int i;
    float f;
    char str[20];
};
```

在这里，`union Data` 定义了一个共用体类型 `Data`，其中包含：
- 一个 `int` 类型的成员 `i`
- 一个 `float` 类型的成员 `f`
- 一个 `char` 数组类型的成员 `str`

### 共用体的特点
1. **共享内存**：共用体的所有成员占用相同的内存地址。无论向哪个成员赋值，都会影响其他成员的值。
2. **大小等于最大成员的大小**：共用体的大小由最大成员的大小决定，以保证任何成员都可以存储。例如，在上面的例子中，`union Data` 的大小等于 `str`（20 字节）的大小，因为 `str` 是最大的成员。
3. **一次只能存储一个有效成员**：在同一时间，共用体中只能有一个成员存储有效数据。修改其中一个成员的值会覆盖其他成员的内容。

### 共用体的使用示例

```c
#include <stdio.h>

union Data {
    int i;
    float f;
    char str[20];
};

int main() {
    union Data data;

    data.i = 10;
    printf("data.i: %d\n", data.i);

    data.f = 220.5;
    printf("data.f: %f\n", data.f);

    // 由于共用体成员共享内存，data.i 的值会被覆盖
    printf("data.i after writing to data.f: %d\n", data.i);

    // 使用字符数组成员
    snprintf(data.str, sizeof(data.str), "Hello");
    printf("data.str: %s\n", data.str);

    return 0;
}
```

在这个例子中，`union Data` 被用来存储不同类型的数据，但每次只能存储一个值：
- 赋值 `data.i = 10` 后，`data.i` 输出为 `10`。
- 赋值 `data.f = 220.5` 后，`data.i` 的内容被覆盖，因此 `data.i` 的值不再是 `10`。
- 赋值 `data.str = "Hello"` 后，共用体再次只保留了 `str` 的值，其他成员变成不确定的值。

### 共用体的用途

1. **节省内存**：共用体适合于存储多种类型，但在同一时刻仅会用到其中之一的情况。例如，解析网络数据包、不同格式的输入输出数据等。
2. **数据类型转换**：在一些场景下，共用体可以用于对相同的二进制数据解释为不同的类型。例如，将一个浮点数数据的二进制位解释为整数。
3. **提高性能**：共用体在数据需要频繁切换的情况下，可以减少内存分配，提升性能。

### 注意事项
- 在同一时间只能使用共用体的一个成员；操作不同成员时会互相覆盖。
- 在使用共用体时，需要确保按正确的类型解释数据，以免出现不可预期的行为。