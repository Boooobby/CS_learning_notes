DDPM（Denoising Diffusion Probabilistic Models）的马尔可夫性（Markov Property）非常核心，它体现在整个模型的**定义结构**上。

简单来说，DDPM 包含了两个过程：**前向过程（加噪）**和**反向过程（去噪）**，这**两个过程全都是马尔可夫链**。

我们可以直接结合你刚读完的 **DDPM 论文（9_DDPM.pdf）第 2 页的公式**来看：

### 1. 前向过程（Forward Process）是马尔可夫链

在论文的 Eq.(2) 中，前向过程定义如下：

$$
q(\mathbf{x}_{1:T}|\mathbf{x}_0) := \prod_{t=1}^T q(\mathbf{x}_t|\mathbf{x}_{t-1})
$$

**体现在哪里？**
*   **公式含义**：右边的连乘 $\prod$ 意味着联合分布被分解成了每一步的条件概率乘积。
*   **马尔可夫性**：要得到时刻 $t$ 的状态 $\mathbf{x}_t$，我们**只依赖于**上一时刻的状态 $\mathbf{x}_{t-1}$。
    *   即：$q(\mathbf{x}_t | \mathbf{x}_{t-1}, \mathbf{x}_{t-2}, \dots, \mathbf{x}_0) = q(\mathbf{x}_t | \mathbf{x}_{t-1})$
*   **物理意义**：当我们给图像加噪时，第 $50$ 步的噪声图像只取决于第 $49$ 步长什么样，跟最开始的原图 $x_0$ 长什么样已经没有**直接**关系了（虽然间接有关，但在概率转移图模型中，箭头是 $x_{t-1} \to x_t$）。

### 2. 反向过程（Reverse Process）也是马尔可夫链

在论文的 Eq.(1) 中，反向（生成）过程定义如下：

$$
p_\theta(\mathbf{x}_{0:T}) := p(\mathbf{x}_T) \prod_{t=1}^T p_\theta(\mathbf{x}_{t-1}|\mathbf{x}_t)
$$

**体现在哪里？**
*   **公式含义**：这是一个从 $\mathbf{x}_T$（纯高斯噪声）开始，一步步往回走的链条。
*   **马尔可夫性**：神经网络在时刻 $t$ 想要预测去噪后的 $\mathbf{x}_{t-1}$ 时，它的输入**只有**当前的 $\mathbf{x}_t$（以及时间嵌入 $t$）。模型不需要知道它之前经历了哪些去噪路径（比如 $\mathbf{x}_{t+1}, \mathbf{x}_{t+2}\dots$）。
    *   即：$p_\theta(\mathbf{x}_{t-1} | \mathbf{x}_t, \mathbf{x}_{t+1}, \dots, \mathbf{x}_T) = p_\theta(\mathbf{x}_{t-1} | \mathbf{x}_t)$

---

### 这里的关键点（对你的科研很有用）：

你既然看过 **DDIM**，这个马尔可夫性就更容易理解其**局限性**和**重要性**的对比了。

1.  **DDPM 为什么这么慢？**
    *   正是因为**马尔可夫性**。因为反向过程严格定义为一步一步走（$x_T \to x_{T-1} \to \dots \to x_0$），你必须基于 $x_t$ 算出 $x_{t-1}$，不能跳步。
    *   这导致采样（Inference）必须串行跑完 1000 步（T=1000），这也是 DiffPure 中提到的时间成本问题（Ref: DiffPure 论文 Table 14，推断时间增加了几百倍）。

2.  **DDIM 做了什么？**
    *   DDIM 的论文标题里就叫 "Non-Markovian Diffusion Probabilistic Models"。
    *   它证明了：训练目标（那个 Loss 或者 Score Function）其实并不依赖前向过程必须是马尔可夫的。
    *   DDIM 构建了一个**非马尔可夫**的前向过程，使得反向过程可以“跳步”（例如从 $x_{100}$ 直接预测 $x_{80}$），从而实现了加速采样。

### 对你的 DiffPure 研究的意义

在你复现 DiffPure 时，你会注意到这个过程：
1.  **Forward (SDE/ODE)**: 把对抗样本 $x_{adv}$ 加噪到 $x(t^*)$。
2.  **Reverse (SDE/ODE)**: 从 $x(t^*)$ 降噪回 $\hat{x}_0$。

虽然 DiffPure 更经常使用 SDE（连续时间）的视角，但在离散化求解（使用 Euler-Maruyama 求解器）时，依然遵循着马尔可夫性质：**每一步的梯度计算只看当前的噪声图**。

**总结：** DDPM 的马尔可夫性体现在它把一个极其复杂的“噪声变图像”的大问题，拆解成了 $T$ 个**只依赖前一步**的简单高斯去噪小问题。这是它数学上可解（Tractable）的根本原因。