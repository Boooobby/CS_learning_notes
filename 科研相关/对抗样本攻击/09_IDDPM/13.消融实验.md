**Section 3 的消融实验（Ablation Studies）** 是为了向审稿人和读者证明：**“我不是运气好才做出来的，我是真的每一个组件都有效。”**

作者主要通过对比实验来论证这一章提出的三个核心改进点的必要性。对于你的 DiffPure 研究来说，看懂这些实验能让你明白**哪些改进是核心，哪些是锦上添花**。

这部分的消融实验主要集中在 **Table 1** 和 **Table 2** 相关的讨论中，主要验证了以下三点：
1.  **学方差（Learned Variance）有没有用？**
2.  **新的 Loss 函数（$L_{hybrid}$）有没有用？**
3.  **余弦调度（Cosine Schedule）有没有用？**

我来为你一一拆解。

---

### 实验 1：学方差 vs. 固定方差 (Learned vs. Fixed Variance)
**—— 验证“加速采样”的核心假设**

*   **设定：**
    *   **基准线（Baseline）：** 原始 DDPM，方差固定为 $\tilde{\beta}_t$。
    *   **改进版（Ours）：** IDDPM，学习方差 $v$。
*   **指标：**
    *   **NLL (Negative Log-Likelihood)：** 越低越好（代表数学分布拟合得好）。
    *   **FID (Fréchet Inception Distance)：** 越低越好（代表图画得像真图）。
*   **结果（Key Finding）：**
    *   在 **T=1000** 步时，两者画质（FID）差不多。这解释了为什么 DDPM 原作者当时觉得没必要学方差。
    *   在 **少步数采样（Low Step Sampling，例如 50 步）** 时：
        *   固定方差模型的 FID **直接爆炸**（画质崩坏）。
        *   学习方差模型的 FID **依然坚挺**。
*   **结论：** 学习方差是实现**少步数快速采样**的关键。这直接支撑了 DiffPure 的实用性。

---

### 实验 2：混合目标函数 (Hybrid Objective)
**—— 验证“鱼与熊掌兼得”的工程技巧**

*   **设定：**
    *   **方案 A ($L_{vlb}$ only)：** 只用变分下界 Loss 训练。
    *   **方案 B ($L_{simple}$ only)：** 只用 MSE Loss 训练（DDPM 原版）。
    *   **方案 C ($L_{hybrid}$)：** 混合 Loss（IDDPM 方案）。
*   **结果：**
    *   **方案 A：** NLL 分数最好（数学指标高），但 **FID 很差**（画出来的图不好看）。
    *   **方案 B：** FID 最棒（图好看），但 **NLL 很差**（数学指标低），且无法有效学习方差系数 $v$（因为梯度其实是断的）。
    *   **方案 C：** FID 和方案 B 一样好，NLL 和方案 A 差不多好。
*   **结论：** $L_{hybrid}$ 成功结合了两者的优点。如果不这么干，你就要么得到一个只会做题不会画画的模型，要么得到一个只会画画但不懂概率的模型。

---

### 实验 3：Cosine Schedule vs. Linear Schedule
**—— 验证“调度优化”的必要性** (Figure 3 & Table 2)

*   **设定：**
    *   对比两种噪点增加的策略（$\beta_t$ 的变化曲线）。
*   **现象（Observation）：**
    *   **Linear Schedule (DDPM)：** 在 ImageNet (64x64) 上，最后的 20% 步数其实图已经全是噪点了，还在那儿硬加噪。这对模型算力是巨大的浪费，而且让 NLL 指标变虚高。
    *   **Cosine Schedule (IDDPM)：** 噪点增加得很慢、很平滑。信号（$\bar{\alpha}_t$）是线性下降的，没有断崖式下跌。
*   **结果：**
    *   使用 Cosine Schedule 后，模型的 **NLL 显著提升**。
    *   这也意味着在采样初期（去噪时），模型能保留更多的语义信息。
*   **对 DiffPure 的意义：** 如果你做的是对抗防御，Cosine Schedule 意味着你的加噪过程更平滑，不容易破坏掉对抗样本中的微小语义结构，也不容易让防御过程即使在很小的 $t$ 也引入过大的破坏。

---

### 总结消融实验的逻辑

作者实际上是想告诉你：

1.  **你想快吗？** 那你必须学方差（Learned Variance）。
2.  **你想学方差又不想画质崩吗？** 那你必须用混合 Loss ($L_{hybrid}$)。
3.  **你想指标再涨几个点吗？** 把 Schedule 改成 Cosine。

这三个组件构成了 IDDPM 的完整体。你在复现 DiffPure 时，如果是基于 IDDPM，**这三个组件缺一不可**，否则性能会打折。