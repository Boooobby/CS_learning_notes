# C++ string类的常用操作详解

string类是C++标准库中最常用的类之一，提供了丰富的字符串操作功能。下面我将分类详细介绍string类的常用操作。

## 一、构造与赋值操作

### 1. 构造函数
```cpp
string str;                // 默认构造，空字符串
string str("Hello");       // 从C字符串构造
string str(5, 'A');        // 构造含5个'A'的字符串
string str(otherStr);      // 拷贝构造
string str(otherStr, 2);   // 从otherStr的下标2开始拷贝
string str(otherStr, 2, 3);// 从otherStr下标2开始拷贝3个字符
```

### 2. 赋值操作
```cpp
str = "Hello";             // 赋值C字符串
str = 'A';                 // 赋值单个字符
str = otherStr;            // 赋值另一个string对象
str.assign("Hello");       // 成员函数赋值
str.assign("Hello", 3);    // 赋值前3个字符
str.assign(5, 'A');        // 赋值5个'A'
```

## 二、元素访问

### 1. 单个字符访问
```cpp
char c = str[1];           // 下标访问，不检查边界
char c = str.at(1);        // 成员函数访问，越界抛出异常
char c = str.front();      // 首字符
char c = str.back();       // 末尾字符
```

### 2. 转换为C风格字符串
```cpp
const char* cstr = str.c_str();  // 返回const char*
const char* data = str.data();   // C++17前不保证以'\0'结尾
```

## 三、容量操作

### 1. 容量查询
```cpp
bool empty = str.empty();  // 是否为空
size_t len = str.size();   // 实际字符数(同length())
size_t cap = str.capacity();// 当前分配的内存容量
```

### 2. 容量调整
```cpp
str.reserve(100);         // 预分配至少100字节的内存
str.shrink_to_fit();      // 减少capacity到size
str.resize(10);           // 调整大小为10，多出部分截断
str.resize(15, 'x');      // 调整大小为15，新增部分用'x'填充
```

## 四、修改操作

### 1. 追加内容
```cpp
str += " World";          // 追加字符串
str.append("!!");         // 成员函数追加
str.push_back('!');       // 追加单个字符
str.insert(5, " dear");   // 在位置5插入字符串
```

### 2. 删除内容
```cpp
str.erase(5, 3);          // 从位置5删除3个字符
str.erase(str.begin()+5); // 删除迭代器指向的字符
str.erase(str.begin(), str.begin()+5); // 删除范围
str.clear();              // 清空字符串
str.pop_back();           // 删除最后一个字符(C++11)
```

### 3. 替换内容
```cpp
str.replace(6, 5, "beautiful"); // 从位置6替换5个字符
str.replace(str.begin(), str.end(), "NEW"); // 迭代器范围替换
```

## 五、字符串操作

### 1. 子串操作
```cpp
string sub = str.substr(6);     // 从位置6到结尾的子串
string sub = str.substr(6, 5);  // 从位置6开始5个字符的子串
```

### 2. 查找操作
```cpp
size_t pos = str.find("lo");    // 查找子串首次出现位置
pos = str.rfind("lo");          // 查找子串最后一次出现位置
pos = str.find_first_of("aeiou"); // 查找任何给定字符首次出现
pos = str.find_last_of("aeiou");  // 查找任何给定字符最后出现
pos = str.find_first_not_of("aeiou"); // 查找非给定字符首次出现
```

### 3. 比较操作
```cpp
int result = str.compare("Hello"); // 比较字符串
result = str.compare(6, 5, "World"); // 比较子串
if(str == "Hello") {...}         // 直接比较运算符
```

## 六、迭代器操作

```cpp
for(auto it = str.begin(); it != str.end(); ++it) {
    cout << *it;                // 正向迭代
}

for(auto rit = str.rbegin(); rit != str.rend(); ++rit) {
    cout << *rit;               // 反向迭代
}

// C++11范围for循环
for(char c : str) {
    cout << c;
}
```

## 七、数值转换(C++11)

### 1. 字符串转数值
```cpp
int i = stoi("42");          // string to int
long l = stol("1000000");    // string to long
float f = stof("3.14");      // string to float
double d = stod("3.14159");  // string to double
```

### 2. 数值转字符串
```cpp
string s1 = to_string(42);     // int to string
string s2 = to_string(3.1415); // double to string
```

## 八、其他实用操作

### 1. 交换字符串
```cpp
string a = "Hello", b = "World";
a.swap(b);  // 或 swap(a, b);
```

### 2. 获取分配器
```cpp
auto alloc = str.get_allocator();
```

### 3. 非成员函数操作
```cpp
string full = str1 + str2;     // 字符串连接
getline(cin, str);             // 读取一行
bool eq = (str1 == str2);      // 比较运算符
```

## 使用建议

1. 对于频繁的字符串拼接，使用`+=`或`append()`比多次使用`+`更高效
2. 预先知道字符串大小时，使用`reserve()`可以减少内存重新分配
3. 只读访问字符串内容时，使用`c_str()`或`data()`获取C风格字符串
4. C++11后，移动语义可以高效地传递字符串所有权
5. 对于子串操作，使用`string_view`(C++17)可以避免不必要的拷贝

这些操作涵盖了string类90%以上的日常使用场景，掌握它们可以高效地处理大多数字符串操作任务。