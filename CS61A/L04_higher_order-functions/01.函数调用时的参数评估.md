# Python 函数调用时参数评估的含义

当说"函数调用时所有参数都会进行评估"时，指的是在调用函数时，Python 会**先完全计算所有参数表达式的值**，然后再将这些值传递给函数。这是 Python 函数调用机制的一个重要特性。

## 详细解释

### 1. 参数评估的顺序

Python 会按照以下顺序处理函数调用：
1. **从左到右**依次评估所有参数表达式
2. 将评估得到的值传递给函数
3. 开始执行函数体

```python
def func(a, b):
    print(a, b)

x = 1
func(x, x + 2)  # 先计算x的值(1)和x+2的值(3)，然后传递给func
```

### 2. 评估的含义

"评估"(evaluation)指的是：
- 对变量求值（获取其当前值）
- 执行任何表达式计算
- 调用其他函数（如果参数中包含函数调用）

```python
def double(x):
    return x * 2

def print_sum(a, b):
    print(a + b)

print_sum(double(3), double(4))  # 先计算double(3)→6和double(4)→8，然后调用print_sum(6,8)
```

### 3. 重要特性

1. **参数表达式在函数执行前就已完成计算**
   ```python
   def func(a):
       print(a)
   
   x = 5
   func(x + 3)  # 先计算x+3得到8，然后传递8给func
   ```

2. **如果参数中有函数调用，会先执行这些函数**
   ```python
   def get_value():
       print("正在获取值")
       return 10
   
   def process(a, b):
       print("处理中", a, b)
   
   process(get_value(), get_value() * 2)
   # 输出顺序:
   # 正在获取值
   # 正在获取值
   # 处理中 10 20
   ```

3. **异常会在参数评估阶段抛出**
   ```python
   def func(a, b):
       pass
   
   func(1, 1/0)  # 在评估第二个参数时就会抛出ZeroDivisionError，函数体不会执行
   ```

## 特殊情况

1. **默认参数**在函数定义时评估一次，而不是每次调用时评估：
   ```python
   def func(a=[]):  # 默认参数a在定义时评估为一个空列表
       a.append(1)
       print(a)
   
   func()  # 输出[1]
   func()  # 输出[1,1] 因为使用的是同一个列表对象
   ```

2. **关键字参数**也是从左到右评估：
   ```python
   def func(a, b, c):
       print(a, b, c)
   
   func(a=1, b=2, c=3)  # 1 2 3
   ```

3. **可变参数(*args, **kwargs)**同样遵循评估规则：
   ```python
   def func(*args):
       print(args)
   
   func(1+2, 3*4)  # 先计算1+2和3*4，然后传递(3,12)
   ```

## 为什么这个特性重要？

理解参数评估顺序有助于：
- 调试时理解表达式求值顺序
- 避免由评估顺序引起的副作用
- 编写更可预测的代码
- 理解某些性能优化技巧

例如，在调用函数前计算复杂表达式有时可以提高性能：
```python
# 较慢 - 每次循环都要计算len(long_list)
for i in range(len(long_list)):
    pass

# 较快 - 只计算一次len(long_list)
list_len = len(long_list)
for i in range(list_len):
    pass
```