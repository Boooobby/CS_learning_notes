# Python 面向对象编程 (OOP) 详解

面向对象编程是 Python 的核心特性之一，它通过类和对象的概念来组织代码，使程序更易于理解、维护和扩展。

## 1. 基本概念

### 类 (Class) 和对象 (Object)
- **类**：是创建对象的蓝图或模板，定义了对象的属性和方法
- **对象**：是类的实例，具有类定义的属性和行为

```python
class Dog:  # 类定义
    pass

my_dog = Dog()  # 创建对象
```

## 2. 类的组成要素

### 构造函数 `__init__`
用于初始化对象的属性

```python
class Dog:
    def __init__(self, name, age):
        self.name = name  # 实例属性
        self.age = age
```

### 实例方法
操作实例属性的函数

```python
class Dog:
    def __init__(self, name):
        self.name = name
        
    def bark(self):  # 实例方法
        print(f"{self.name} says woof!")
```

### 类属性
所有实例共享的属性

```python
class Dog:
    species = "Canis familiaris"  # 类属性
    
    def __init__(self, name):
        self.name = name
```

## 3. 面向对象的四大特性

### 封装 (Encapsulation)
隐藏内部实现细节，只暴露必要接口

```python
class BankAccount:
    def __init__(self):
        self.__balance = 0  # 私有属性
        
    def deposit(self, amount):
        if amount > 0:
            self.__balance += amount
            
    def get_balance(self):
        return self.__balance
```

### 继承 (Inheritance)
子类继承父类的属性和方法

```python
class Animal:
    def __init__(self, name):
        self.name = name
        
    def speak(self):
        raise NotImplementedError("子类必须实现此方法")

class Dog(Animal):  # 继承Animal
    def speak(self):
        return "Woof!"
```

### 多态 (Polymorphism)
不同类对象对同一消息做出不同响应

```python
class Cat(Animal):
    def speak(self):
        return "Meow!"

animals = [Dog("Rex"), Cat("Misty")]
for animal in animals:
    print(animal.speak())  # 多态调用
```

### 抽象 (Abstraction)
Python 通过抽象基类(ABC)实现

```python
from abc import ABC, abstractmethod

class Shape(ABC):
    @abstractmethod
    def area(self):
        pass

class Circle(Shape):
    def __init__(self, radius):
        self.radius = radius
        
    def area(self):
        return 3.14 * self.radius ** 2
```

## 4. 高级特性

### 类方法和静态方法

```python
class MyClass:
    class_variable = "类变量"
    
    @classmethod
    def class_method(cls):
        print(f"访问类变量: {cls.class_variable}")
        
    @staticmethod
    def static_method():
        print("与类无关的静态方法")
```

### 属性装饰器
控制属性的访问

```python
class Person:
    def __init__(self, name):
        self._name = name
        
    @property
    def name(self):
        return self._name
        
    @name.setter
    def name(self, value):
        if not isinstance(value, str):
            raise ValueError("名字必须是字符串")
        self._name = value
```

### 魔术方法 (Magic Methods)
特殊方法，以双下划线开头和结尾

```python
class Vector:
    def __init__(self, x, y):
        self.x = x
        self.y = y
        
    def __add__(self, other):  # 重载+运算符
        return Vector(self.x + other.x, self.y + other.y)
        
    def __str__(self):  # 定义打印格式
        return f"Vector({self.x}, {self.y})"
```

## 5. 设计原则

### SOLID 原则
1. **单一职责原则**：一个类只做一件事
2. **开闭原则**：对扩展开放，对修改关闭
3. **里氏替换原则**：子类可以替换父类
4. **接口隔离原则**：多个专用接口优于一个通用接口
5. **依赖倒置原则**：依赖抽象而非具体实现

## 6. 实际应用示例

```python
class Employee:
    def __init__(self, name, salary):
        self.name = name
        self.salary = salary
        
    def raise_salary(self, percent):
        self.salary *= (1 + percent/100)
        
    def __str__(self):
        return f"{self.name}: ${self.salary:.2f}"

class Manager(Employee):
    def __init__(self, name, salary, department):
        super().__init__(name, salary)
        self.department = department
        
    def raise_salary(self, percent, bonus=0):
        super().raise_salary(percent + bonus)

# 使用
emp = Employee("John", 50000)
mgr = Manager("Alice", 80000, "IT")
emp.raise_salary(10)
mgr.raise_salary(10, 5)
print(emp)  # John: $55000.00
print(mgr)  # Alice: $92000.00
```

Python 的面向对象编程提供了强大的工具来创建清晰、模块化和可重用的代码结构。掌握这些概念可以帮助你编写更高效、更易维护的程序。