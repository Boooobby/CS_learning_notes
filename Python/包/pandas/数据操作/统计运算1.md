在`pandas`中，统计运算是数据分析中非常常见的操作。`DataFrame`和`Series`都提供了丰富的统计方法，可以方便地进行数据汇总、聚合、分组统计等操作。以下是一些常用的统计运算知识点和操作。

### **1. 基本统计方法**

#### 1.1 **`sum()`**
返回所有元素的总和。对于`DataFrame`，可以选择按行（`axis=1`）或按列（`axis=0`）求和。

```python
import pandas as pd

df = pd.DataFrame({
    'A': [1, 2, 3],
    'B': [4, 5, 6]
})

# 按列求和（默认按列）
result = df.sum()
print(result)
# 输出：
# A    6
# B    15

# 按行求和
result = df.sum(axis=1)
print(result)
# 输出：
# 0     5
# 1     7
# 2     9
```

#### 1.2 **`mean()`**
返回每列（或每行）的均值。

```python
# 计算每列的均值
result = df.mean()
print(result)
# 输出：
# A    2.0
# B    5.0

# 计算每行的均值
result = df.mean(axis=1)
print(result)
# 输出：
# 0    2.5
# 1    3.5
# 2    4.5
```

#### 1.3 **`median()`**
返回每列（或每行）的中位数。

```python
# 计算每列的中位数
result = df.median()
print(result)
# 输出：
# A    2.0
# B    5.0
```

#### 1.4 **`min()` / `max()`**
返回每列（或每行）的最小值和最大值。

```python
# 计算每列的最小值和最大值
result_min = df.min()
result_max = df.max()

print(result_min)  # 输出每列的最小值
print(result_max)  # 输出每列的最大值
```

#### 1.5 **`std()`**
返回每列（或每行）的标准差。

```python
# 计算每列的标准差
result = df.std()
print(result)
# 输出：
# A    1.0
# B    1.0
```

#### 1.6 **`var()`**
返回每列（或每行）的方差。

```python
# 计算每列的方差
result = df.var()
print(result)
# 输出：
# A    1.0
# B    1.0
```

#### 1.7 **`count()`**
返回每列（或每行）非空值的数量。

```python
# 计算每列的非空值数量
result = df.count()
print(result)
# 输出：
# A    3
# B    3
```

#### 1.8 **`describe()`**
返回一个包含多种统计信息的摘要，包括：计数（`count`）、均值（`mean`）、标准差（`std`）、最小值（`min`）、四分位数（`25%`, `50%`, `75%`）和最大值（`max`）。

```python
# 生成描述性统计信息
result = df.describe()
print(result)
```

**输出**：
```
         A    B
count  3.0  3.0
mean   2.0  5.0
std    1.0  1.0
min    1.0  4.0
25%    1.5  4.5
50%    2.0  5.0
75%    2.5  5.5
max    3.0  6.0
```

#### 1.9 **`prod()`**
计算元素的乘积。

```python
# 计算每列元素的乘积
result = df.prod()
print(result)
# 输出：
# A     6
# B    120
```

---

### **2. 聚合操作（Aggregation）**

聚合操作常常用于将数据按某些条件汇总。常见的聚合操作包括 `groupby()`、`pivot_table()` 等。

#### 2.1 **`groupby()`**
将数据按某个（或多个）列分组，然后对每个组进行统计运算。`groupby()` 会返回一个 `GroupBy` 对象，需要进一步调用聚合函数（如 `sum()`, `mean()`）进行计算。

```python
df = pd.DataFrame({
    'Category': ['A', 'A', 'B', 'B', 'C', 'C'],
    'Value': [10, 20, 30, 40, 50, 60]
})

# 按 Category 列分组，计算每组的总和
result = df.groupby('Category').sum()
print(result)
```

**输出**：
```
          Value
Category       
A            30
B            70
C           110
```

#### 2.2 **`pivot_table()`**
`pivot_table()` 用于创建透视表，可以对数据进行汇总和聚合。

```python
df = pd.DataFrame({
    'Category': ['A', 'A', 'B', 'B', 'C', 'C'],
    'Type': ['X', 'Y', 'X', 'Y', 'X', 'Y'],
    'Value': [10, 20, 30, 40, 50, 60]
})

# 按 Category 和 Type 列进行分组，计算每组的平均值
result = df.pivot_table(values='Value', index='Category', columns='Type', aggfunc='mean')
print(result)
```

**输出**：
```
Type        X     Y
Category          
A         10.0  20.0
B         30.0  40.0
C         50.0  60.0
```

---

### **3. 排序和排名操作**

#### 3.1 **`sort_values()`**
按指定列的值对 `DataFrame` 进行排序。

```python
df = pd.DataFrame({
    'A': [1, 2, 3],
    'B': [4, 5, 6]
})

# 按列 B 排序
result = df.sort_values(by='B', ascending=False)
print(result)
```

**输出**：
```
   A  B
2  3  6
1  2  5
0  1  4
```

#### 3.2 **`rank()`**
返回 `Series` 或 `DataFrame` 中元素的排名。

```python
df = pd.DataFrame({
    'A': [1, 2, 3],
    'B': [4, 5, 6]
})

# 对每列进行排名
result = df.rank()
print(result)
```

**输出**：
```
     A    B
0  1.0  1.0
1  2.0  2.0
2  3.0  3.0
```

---

### **4. 缺失值处理**

#### 4.1 **`isna()` / `isnull()`**
判断数据中是否有缺失值。

```python
df = pd.DataFrame({
    'A': [1, 2, None],
    'B': [4, None, 6]
})

result = df.isna()
print(result)
```

**输出**：
```
       A      B
0  False  False
1  False   True
2   True  False
```

#### 4.2 **`fillna()`**
用指定的值填充缺失值。

```python
result = df.fillna(0)
print(result)
```

**输出**：
```
   A  B
0  1  4
1  2  0
2  0  6
```

#### 4.3 **`dropna()`**
删除包含缺失值的行或列。

```python
result = df.dropna()  # 删除含有NaN的行
print(result)
```

**输出**：
```
   A    B
0  1  4.0
```

---

### **5. 相关性和协方差**

#### 5.1 **`corr()`**
计算列之间的相关系数。

```python
df = pd.DataFrame({
    'A': [1, 2, 3],
    'B': [4, 5, 6],
    'C': [7, 8, 9]
})

# 计算列与列之间的相关系数
result = df.corr()
print(result)
```

**输出**：
```
     A    B    C
A  1.0  1.0  1.0
B  1.0  1.0  1.0
C

  1.0  1.0  1.0
```

#### 5.2 **`cov()`**
计算列之间的协方差。

```python
result = df.cov()
print(result)
```

**输出**：
```
     A    B    C
A  1.0  1.0  1.0
B  1.0  1.0  1.0
C  1.0  1.0  1.0
```

---

### **总结**

`pandas`提供了丰富的统计运算方法，常见的有：求和、均值、中位数、最小最大值、标准差、方差、计数等。通过`groupby()`、`pivot_table()`等聚合方法，能帮助我们对数据进行更加深入的统计分析。