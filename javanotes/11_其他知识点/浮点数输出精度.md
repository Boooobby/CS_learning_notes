### **Java 浮点数输出精度总结**  

#### **1. 默认输出行为**
- **`double`**：默认显示 **15~16 位有效数字**，并**省略末尾无意义的 `0`**。
  ```java
  System.out.println(123.0);    // 输出: 123.0（或 123，取决于环境）
  System.out.println(123.456);  // 输出: 123.456
  ```
- **`float`**：默认显示 **6~7 位有效数字**，同样省略末尾 `0`。
  ```java
  System.out.println(123.456f); // 输出: 123.456
  ```

#### **2. 科学计数法**
- 当数值过大或过小时，Java 会自动转换为科学计数法（`E` 表示法）。
  ```java
  System.out.println(123456789.0); // 输出: 1.23456789E8
  System.out.println(0.000000123); // 输出: 1.23E-7
  ```

#### **3. 浮点数精度问题**
- **二进制浮点数无法精确表示某些十进制小数**（如 `0.1`、`0.2`），导致计算误差：
  ```java
  System.out.println(0.1 + 0.2); // 输出: 0.30000000000000004
  System.out.println(12.6 - 8.3); // 输出: 4.300000000000001
  ```
- **但某些值可以精确表示**（如 `0.5`、`3.5`），因此输出正常：
  ```java
  System.out.println(3.5); // 输出: 3.5
  ```

#### **4. 控制输出精度（格式化）**
| 方法 | 示例 | 说明 |
|------|------|------|
| **`String.format()`** | `String.format("%.2f", 3.14159)` | 保留 2 位小数，四舍五入 |
| **`DecimalFormat`** | `new DecimalFormat("#.##").format(3.14159)` | 灵活控制格式（`#` 可选，`0` 强制补位） |
| **`System.out.printf()`** | `System.out.printf("%.2f%n", 3.14159)` | 类似 C 语言的 `printf` |

#### **5. 精确计算场景**
- 使用 **`BigDecimal`** 避免浮点数误差（适用于财务计算）：
  ```java
  BigDecimal a = new BigDecimal("12.6");
  BigDecimal b = new BigDecimal("8.3");
  System.out.println(a.subtract(b)); // 输出: 4.3（精确）
  ```
  - **注意**：构造 `BigDecimal` 时**必须用字符串**，否则仍会传入浮点数误差：
    ```java
    new BigDecimal(12.6); // 错误！会传入不精确的 12.600000000000001
    new BigDecimal("12.6"); // 正确
    ```

---

### **总结表格**
| 场景 | 问题 | 解决方案 |
|------|------|----------|
| 默认打印浮点数 | 省略末尾 `0`，可能显示科学计数法 | 使用格式化（如 `%.2f`） |
| 浮点数计算误差（如 `0.1 + 0.2`） | 输出 `0.30000000000000004` | 用 `BigDecimal` 或四舍五入 |
| 强制保留小数位（如 `3.5` → `3.50`） | 默认不补 `0` | `DecimalFormat("0.00")` |

**关键原则**：
1. **默认输出简洁**，但可能有精度问题。
2. **需要固定位数或精确结果时，必须手动格式化或使用 `BigDecimal`**。
3. **科学计算可用 `double`，金融计算必用 `BigDecimal`**。

掌握这些后，就能灵活应对 Java 浮点数输出了！ 🎯